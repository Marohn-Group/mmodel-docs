

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Creating a model graph &#8212; MModel 0.6.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial_graph';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building a model" href="tutorial_model.html" />
    <link rel="prev" title="Changelog" href="changelog.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">MModel 0.6.2 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Creating a model graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_model.html">Building a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_modifier.html">Modifying model and node</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_subgraph.html">Modifying a subgraph</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Guideline</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="api_handler.html">Handler API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_modifier.html">Modifier API</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ref_graph.html">Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref_model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref_handler.html">Handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref_modifier.html">Modifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref_filter.html">Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref_parser.html">Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref_shortcut.html">Shortcut</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/tutorial_graph.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Creating a model graph</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-a-graph">Define a graph</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-node-objects">Set node objects</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-function-input-parameters">Change function input parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-functions-and-functions-without-signature">Built-in functions and functions without signature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-with-variable-length-of-arguments">Function with variable length of arguments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-with-default-arguments">Function with default arguments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#name-and-docstring">Name and docstring</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mutability">Mutability</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="creating-a-model-graph">
<h1>Creating a model graph<a class="headerlink" href="#creating-a-model-graph" title="Permalink to this heading">#</a></h1>
<p>A directed acyclic graph (DAG) is a directed graph without any cycles.
The model graphs in <code class="docutils literal notranslate"><span class="pre">mmodel</span></code> are based on the DAG, where each node represents
an execution step, and each edge represents the data flow from one callable
to another. DAG structure allows us to create model graphs with nonlinear
nodes.</p>
<section id="define-a-graph">
<h2>Define a graph<a class="headerlink" href="#define-a-graph" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ModelGraph</span></code> class is the main graph class to establish a model graph.
The class inherits from <code class="docutils literal notranslate"><span class="pre">networkx.DiGraph</span></code>, which is compatible with all
<code class="docutils literal notranslate"><span class="pre">networkx</span></code> operations
(see <a class="reference external" href="https://networkx.org/documentation/stable/">documentation</a>).
To create and modify the graph,
see the documentation for adding
<a class="reference external" href="https://networkx.org/documentation/stable/tutorial.html#nodes">nodes</a>
and adding <a class="reference external" href="https://networkx.org/documentation/stable/tutorial.html#edges">edges</a>.</p>
<p>Aside from the <code class="docutils literal notranslate"><span class="pre">networkx</span></code> operations,
<code class="docutils literal notranslate"><span class="pre">mmodel</span></code> provides <code class="docutils literal notranslate"><span class="pre">add_grouped_edge</span></code> and <code class="docutils literal notranslate"><span class="pre">add_grouped_edges_from</span></code> to add edges.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mmodel</span> <span class="kn">import</span> <span class="n">ModelGraph</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">ModelGraph</span><span class="p">()</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_grouped_edge</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="c1"># equivalent to</span>
<span class="c1"># G.add_edge(&#39;a&#39;, &#39;b&#39;)</span>
<span class="c1"># G.add_edge(&#39;a&#39;, &#39;c&#39;)</span>
</pre></div>
</div>
<p>Similarly, with multiple grouped edges</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_edges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]),</span>
<span class="p">]</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">ModelGraph</span><span class="p">()</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_grouped_edges_from</span><span class="p">(</span><span class="n">grouped_edges</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">ModelGraph</span> <span class="k">with</span> <span class="mi">5</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="mi">4</span> <span class="n">edges</span>
</pre></div>
</div>
</section>
<section id="set-node-objects">
<h2>Set node objects<a class="headerlink" href="#set-node-objects" title="Permalink to this heading">#</a></h2>
<p>Each node in the graph represents an execution, and the edges represent the data
flow. Therefore we need to link the node to its execution method. In <code class="docutils literal notranslate"><span class="pre">mmodel</span></code>
a node object is a combination of:</p>
<ol class="arabic simple">
<li><p>callable, function, or function-like (“func”)</p></li>
<li><p>callable return variable name (“output”)</p></li>
<li><p>callable input parameter list (“inputs”)</p></li>
<li><p>modifications list (“modifiers”)</p></li>
</ol>
<p>For linking the node object to the node, two methods are provided:
<code class="docutils literal notranslate"><span class="pre">set_node_object</span></code> and <code class="docutils literal notranslate"><span class="pre">set_node_objects_from</span></code>.
The latter accepts a list of node objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The sum of x and y.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The difference between x and y.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>


<span class="n">G</span><span class="o">.</span><span class="n">set_node_object</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">add</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>


<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">node_metadata</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="n">a</span>

<span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">return</span><span class="p">:</span> <span class="n">z</span>
<span class="n">functype</span><span class="p">:</span> <span class="nb">callable</span>

<span class="n">The</span> <span class="nb">sum</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span>

<span class="c1"># or with multiple node objects</span>
<span class="c1"># both nodes add input values but outputs in different parameter</span>
<span class="n">node_objects</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">subtract</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_node_objects_from</span><span class="p">(</span><span class="n">node_objects</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">node_metadata</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">))</span>
<span class="n">b</span>

<span class="n">subtract</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">return</span><span class="p">:</span> <span class="n">m</span>
<span class="n">functype</span><span class="p">:</span> <span class="nb">callable</span>

<span class="n">The</span> <span class="n">difference</span> <span class="n">between</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The object is stored as a node attribute and the function signature
(<cite>inspect.Signature</cite>) is stored. The parameter values are converted
to signature objects.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To have the docstring properly displayed in node’s metadata, it needs to start
with an upper case letter and ends with a period.</p>
</div>
<p>The name of the parameters that pass through each edge is determined and stored
in the edge attribute “var”.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The note output is a single variable. If the node outputs the multiple variables
the return tuple is assigned to the defined output variable.</p>
</div>
<section id="change-function-input-parameters">
<h3>Change function input parameters<a class="headerlink" href="#change-function-input-parameters" title="Permalink to this heading">#</a></h3>
<p>To avoid re-defining functions using different input parameters, or for functions
that only allow positional arguments (built-in functions and numpy.ufunc), the
“inputs” parameter of the <code class="docutils literal notranslate"><span class="pre">set_node_object</span></code> can change the node signature.
The signature replacement is a thin wrapper with a very small performance overhead.
The signature change only occurs at the node level, the original function is
not affected.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sum of x and y.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">G</span><span class="o">.</span><span class="n">set_node_object</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">add</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">node_metadata</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="n">a</span>

<span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="k">return</span><span class="p">:</span> <span class="n">z</span>
<span class="n">functype</span><span class="p">:</span> <span class="nb">callable</span>

<span class="n">Sum</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The graph variable flows restricts to keyword arguments only for function parameters.
They can be modified by changing the inputs of the function, and the modified
function allows keyword arguments.</p>
</div>
</section>
<section id="built-in-functions-and-functions-without-signature">
<h3>Built-in functions and functions without signature<a class="headerlink" href="#built-in-functions-and-functions-without-signature" title="Permalink to this heading">#</a></h3>
<p>There are different types of functions that <code class="docutils literal notranslate"><span class="pre">inspect.signature</span></code> cannot extract
the parameters from, namely:</p>
<ol class="arabic simple">
<li><p>python’s built-in functions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> ufuncs</p></li>
</ol>
<p>mmodel can identify the above functions, and replace the signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>

<span class="n">G</span><span class="o">.</span><span class="n">set_node_object</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">add</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">G</span><span class="o">.</span><span class="n">set_node_object</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">])</span>


<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">node_metadata</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="n">a</span>

<span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="k">return</span><span class="p">:</span> <span class="n">z</span>
<span class="n">functype</span><span class="p">:</span> <span class="n">builtin</span>

<span class="n">Same</span> <span class="k">as</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span>


<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">node_metadata</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="n">b</span>

<span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="k">return</span><span class="p">:</span> <span class="n">z</span>
<span class="n">functype</span><span class="p">:</span> <span class="nb">callable</span>

<span class="n">Sum</span> <span class="n">of</span> <span class="n">array</span> <span class="n">elements</span> <span class="n">over</span> <span class="n">a</span> <span class="n">given</span> <span class="n">axis</span><span class="o">.</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">set_node_object</span></code> method can also accept additional keyword arguments that is
stored in the graph node attribute. The “doc” attribute is reserved for the docstring
of the function, however, it can be overridden by the user.</p>
</section>
<section id="function-with-variable-length-of-arguments">
<h3>Function with variable length of arguments<a class="headerlink" href="#function-with-variable-length-of-arguments" title="Permalink to this heading">#</a></h3>
<p>In mmodel graph, the argument length of a node is fixed. For a function with variable
length of arguments, additional arguments can be provided using the input function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_func_kwargs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">kwargs</span>


<span class="n">G</span><span class="o">.</span><span class="n">set_node_object</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">test_func_kwargs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">node_metadata</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="n">a</span>

<span class="n">test_func_kwargs</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="k">return</span><span class="p">:</span> <span class="n">z</span>
<span class="n">functype</span><span class="p">:</span> <span class="nb">callable</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">][</span><span class="s2">&quot;func&quot;</span><span class="p">](</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="function-with-default-arguments">
<h3>Function with default arguments<a class="headerlink" href="#function-with-default-arguments" title="Permalink to this heading">#</a></h3>
<p>For functions with default arguments, the inputs can be shorter than the total number
of parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_func_defaults</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">m</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">p</span>

<span class="n">G</span><span class="o">.</span><span class="n">set_node_object</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">test_func_defaults</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">node_metadata</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="n">a</span>

<span class="n">test_func_defaults</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="k">return</span><span class="p">:</span> <span class="n">z</span>
<span class="n">functype</span><span class="p">:</span> <span class="nb">callable</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">][</span><span class="s2">&quot;func&quot;</span><span class="p">](</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">5</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To avoid performance overhead, signature_modifier modifies the signature in order.
Currently, it is not possible to replace selected parameters.</p>
</div>
</section>
</section>
<section id="name-and-docstring">
<h2>Name and docstring<a class="headerlink" href="#name-and-docstring" title="Permalink to this heading">#</a></h2>
<p>The name and graph string behaves as the networkx graphs. To add the name to the graph:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># during graph definition</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">ModelGraph</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;ModelGraph Example&quot;</span><span class="p">)</span>

<span class="c1"># after definition</span>
<span class="c1"># G.graph[&#39;name&#39;] = &#39;ModelGraph Example&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">ModelGraph</span> <span class="n">named</span> <span class="s1">&#39;ModelGraph Example&#39;</span> <span class="k">with</span> <span class="mi">0</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">edges</span>
</pre></div>
</div>
</section>
<section id="mutability">
<h2>Mutability<a class="headerlink" href="#mutability" title="Permalink to this heading">#</a></h2>
<p>The graph object is mutable. A shallow or deepcopy might be needed to create a copy
of the graph.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># shallow copy</span>
<span class="n">G</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span> <span class="c1"># deep copy</span>
</pre></div>
</div>
<p>For more ways to interact with ModelGraph, and networkx.graph see
<a class="reference internal" href="ref_graph.html"><span class="doc">graph reference</span></a>.</p>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="changelog.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Changelog</p>
      </div>
    </a>
    <a class="right-next"
       href="tutorial_model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Building a model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-a-graph">Define a graph</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-node-objects">Set node objects</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-function-input-parameters">Change function input parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-functions-and-functions-without-signature">Built-in functions and functions without signature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-with-variable-length-of-arguments">Function with variable length of arguments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-with-default-arguments">Function with default arguments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#name-and-docstring">Name and docstring</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mutability">Mutability</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peter Sun
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, Peter Sun.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>